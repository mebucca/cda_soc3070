---
title: "SOL3070 Análisis de Datos Categóricos"  
author: "Tarea corta 2"  
format: html
editor: visual  
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library("tinytex")
library("ggplot2")
library("dplyr")
```

**`Ponderación:`** `5% de la nota final del curso.`

<br>

Un jugador lanza **dos monedas** (no necesariamente justas) en cada ronda $i$. Sea $X_i$ el número de caras en el lanzamiento $i$. La probabilidad de que una moneda muestre cara es $p$, y las monedas son independientes.

La siguiente tabla muestra los resultados de **3 lanzamientos** observados:

| Tirada | $X_i$: número de caras |
|--------|------------------------|
| 1      | 0                      |
| 2      | 2                      |
| 3      | 2                      |


## Preguntas

### 1) Distribución de probabilidad de $X_i$

Explica por qué $X_i$ sigue una distribución binomial, escribe explícitamente la función probabilidad de $X_i$ y expresa las probabilidades de obtener $X_i=0$, $X_i=1$ y $X_i=2$ en términos de $p$.


### 2) Variable de ganancia $Y$

El casino paga de la siguiente manera:  
- $X=2$: gana **$2000**.  
- $X=1$: gana **$500**.  
- $X=0$: pierde **$1000**.  

Define la variable de ganancia $Y$ y escribe su distribución de probabilidad.


### 3) Valor esperado de $Y$

Usando la distribución encontrada en la pregunta anterior, calcula el valor esperado $\mathbb{E}[Y]$.


### 4) Log-likelihood function de $p$ con los datos observados

A partir de los datos observados (un 0 y dos 2), construye la función de verosimilitud $L(p)$ mostrando el producto de probabilidades individuales, simplifícala, y luego transforma a log-verosimilitud $\ell(p)$.


### 5) Graficar la log-likelihood

Escribe el código en R para graficar la log-likelihood $\ell(p)$ en el rango $p \in [0,1]$. Reemplaza `\_agrega_aqui_tu_funcion_` con la expresión encontrada en la pregunta 4.

```{r, echo=TRUE, eval=FALSE, warning=FALSE, message=FALSE}
mydata <- data.frame(p = seq(0.01, 0.99, by=0.01)) %>%
  mutate(logLik = `_agrega_aqui_tu_funcion_`)

ggplot(mydata, aes(x=p, y=logLik)) +
  geom_line(color="#AA134e", linewidth=1.2) +
  labs(x="Probabilidad de cara (p)", y="Log-likelihood",
       title="Log-likelihood function de p (datos: 0,2,2)") +
  theme_bw()
```


### 6) Estimación visual de $p$

Basándote en el gráfico anterior, estima visualmente el valor de $\hat{p}$ que maximiza la log-likelihood e interpreta su significado en este contexto.
